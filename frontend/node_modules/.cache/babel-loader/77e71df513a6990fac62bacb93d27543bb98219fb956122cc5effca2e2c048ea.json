{"ast":null,"code":"import React,{useContext,useEffect,useRef,useState}from\"react\";import{useHistory}from\"react\";import{AuthContext}from\"../../shared/context/auth-context\";import LoadinSpinner from'./../../shared/loadingSpinner/LoadingSpinner';import'./Upload.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Upload=props=>{const[tagsDB,setTagsDB]=useState();const[images,setImages]=useState([]);const[previewImage,setPreviewImage]=useState([]);const[title,setTitle]=useState();const[description,setDescription]=useState();const[price,setPrice]=useState(0);const[tags,setTags]=useState([]);const[file,setFile]=useState();const[loading,setLoading]=useState(false);const imagesRef=useRef();const auth=useContext(AuthContext);const history=useHistory();const tagsSelectorHandler=event=>{let options=event.currentTarget.selectedOptions;let values=[];for(let i=0;i<options.length;i++)values.push(options[i].value);console.log(values);setTags(values);};const imagesLoadHandler=event=>{let image=event.target.files[0];setImages([...images,image]);let fileReader=new FileReader();fileReader.onload=()=>{setPreviewImage([...previewImage,fileReader.result]);};fileReader.readAsDataURL(image);};useEffect(()=>{fetch('http://localhost:5000/tag/tags',{method:'GET',headers:{'Content-Type':'application/json'}}).then(res=>res.json()).then(data=>setTagsDB(data.tags));},[]);const submitHandler=async event=>{event.preventDefault();setLoading(true);try{let formData=new FormData();formData.append('productName',title);for(let i=0;i<tags.length;i++)formData.append('tags',tags[i]);formData.append('description',description);formData.append('files',file);for(let i=0;i<images.length;i++)formData.append('files',images[i]);formData.append('price',price);formData.append('ownerId',auth.userId);console.log(formData.get('tags'));const res=await fetch('http://localhost:5000/product/upload',{method:'POST',headers:{Authorization:'breaer '+auth.token},body:formData});const data=await res.json();if(res.ok)history.push('/');console.log(data.message);}catch(err){console.log(err);}setLoading(false);};document.title=\"Upload\";return/*#__PURE__*/_jsxs(\"div\",{className:\"container-upload\",style:{backgroundImage:'url(http://localhost:5000/static/images/image3.jpg)'},children:[/*#__PURE__*/_jsx(LoadinSpinner,{isLoading:loading}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Upload Product\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,children:[/*#__PURE__*/_jsx(\"label\",{children:\"Title\"}),/*#__PURE__*/_jsx(\"input\",{className:\"name\",onChange:event=>setTitle(event.target.value)}),/*#__PURE__*/_jsx(\"label\",{children:\"Tags\"}),/*#__PURE__*/_jsx(\"select\",{className:\"tags\",multiple:true,onChange:tagsSelectorHandler,children:tagsDB&&tagsDB.map(tag=>/*#__PURE__*/_jsx(\"option\",{value:tag.id,children:tag.tagName},tag.id))}),/*#__PURE__*/_jsx(\"label\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"description\",onChange:event=>setDescription(event.target.value)}),/*#__PURE__*/_jsx(\"label\",{children:\"Images\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"images\",children:[previewImage&&previewImage.map((img,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"img-card\",children:[/*#__PURE__*/_jsx(\"img\",{src:img}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setImages(images.filter((item,i)=>index!=i));setPreviewImage(previewImage.filter((item,i)=>index!=i));},children:\"remove\"})]},img)),/*#__PURE__*/_jsx(\"div\",{className:\"add-button\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{imagesRef.current.click();},children:\"Add Image\"})})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{style:{display:'none'},ref:imagesRef,onChange:imagesLoadHandler,className:\"image-input\",name:\"images\",type:'file',accept:'.jpg , .png , .jpeg'})}),/*#__PURE__*/_jsx(\"label\",{children:\"File\"}),/*#__PURE__*/_jsx(\"input\",{className:\"file\",name:\"file\",type:'file',onChange:event=>setFile(event.target.files[0]),accept:\".rar , .zip , .tar\"}),/*#__PURE__*/_jsx(\"label\",{children:\"Price\"}),/*#__PURE__*/_jsx(\"input\",{className:\"price\",type:'number',min:1,max:10000,onChange:event=>setPrice(event.target.value)}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"upload\"})]})]})]});};export default Upload;","map":{"version":3,"names":["React","useContext","useEffect","useRef","useState","useHistory","AuthContext","LoadinSpinner","jsx","_jsx","jsxs","_jsxs","Upload","props","tagsDB","setTagsDB","images","setImages","previewImage","setPreviewImage","title","setTitle","description","setDescription","price","setPrice","tags","setTags","file","setFile","loading","setLoading","imagesRef","auth","history","tagsSelectorHandler","event","options","currentTarget","selectedOptions","values","i","length","push","value","console","log","imagesLoadHandler","image","target","files","fileReader","FileReader","onload","result","readAsDataURL","fetch","method","headers","then","res","json","data","submitHandler","preventDefault","formData","FormData","append","userId","get","Authorization","token","body","ok","message","err","document","className","style","backgroundImage","children","isLoading","onSubmit","onChange","multiple","map","tag","id","tagName","img","index","src","type","onClick","filter","item","current","click","display","ref","name","accept","min","max"],"sources":["/home/anjali/shri/Freelance/frontend/src/pages/Upload/Upload.js"],"sourcesContent":["import React, { useContext, useEffect, useRef, useState } from \"react\";\nimport { useHistory } from \"react\";\nimport { AuthContext } from \"../../shared/context/auth-context\";\nimport LoadinSpinner from './../../shared/loadingSpinner/LoadingSpinner'\nimport './Upload.css'\n\n\nconst Upload = props => {\n    const [tagsDB, setTagsDB] = useState();\n    const [images, setImages] = useState([]);\n    const [previewImage, setPreviewImage] = useState([]);\n\n    const [title, setTitle] = useState()\n    const [description, setDescription] = useState()\n    const [price, setPrice] = useState(0)\n    const [tags ,setTags] = useState([])\n    const [file ,setFile] = useState()\n\n\n    const [loading,setLoading] = useState(false)\n\n    const imagesRef= useRef()\n\n    const auth = useContext(AuthContext)\n\n    const history = useHistory();\n\n    const tagsSelectorHandler = event => {\n        let options = event.currentTarget.selectedOptions\n        let values = []\n        for(let i =0; i<options.length; i++)\n            values.push(options[i].value)\n        console.log(values)\n        setTags(values)\n    }\n    const imagesLoadHandler = event => {\n        let image = event.target.files[0]\n        setImages([...images , image])\n\n        let fileReader = new FileReader()\n\n    \n        fileReader.onload = () => {\n           setPreviewImage([...previewImage, fileReader.result])\n        }\n\n        fileReader.readAsDataURL(image);\n\n\n\n    }\n\n    useEffect(() => {\n\n        fetch('http://localhost:5000/tag/tags', {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        }).then(res => res.json()).then(data => setTagsDB(data.tags))\n    }, [])\n\n\n    const submitHandler = async event =>{\n        event.preventDefault()\n        setLoading(true)\n        try{\n            let formData = new FormData()\n            formData.append('productName',title);\n            for(let i=0; i< tags.length ; i++)\n                formData.append('tags',tags[i]);\n            formData.append('description',description);\n            formData.append('files',file)\n            for(let i=0; i< images.length ; i++)\n                formData.append('files',images[i]); \n            formData.append('price',price);\n            formData.append('ownerId',auth.userId);\n\n            console.log(formData.get('tags'))\n\n            const res = await fetch('http://localhost:5000/product/upload',{\n                method:'POST',\n                headers:{\n                    Authorization:'breaer '+auth.token\n                },\n                body: formData\n            })\n            const data = await res.json()\n            if(res.ok)\n                history.push('/')\n            console.log(data.message)\n        }catch(err){\n            console.log(err)\n        }\n        setLoading(false)\n\n    }\n    \n    document.title = \"Upload\"\n    return  <div className=\"container-upload\"  style={{ backgroundImage: 'url(http://localhost:5000/static/images/image3.jpg)' }} >\n        <LoadinSpinner  isLoading={loading}  /> \n        <div className=\"upload\">\n            <h1>Upload Product</h1>\n            <form onSubmit={submitHandler}>\n                <label>Title</label>\n                <input className=\"name\" onChange={event=>setTitle(event.target.value)} />\n\n                <label>Tags</label>\n                <select className=\"tags\" multiple onChange={tagsSelectorHandler}>\n                    {tagsDB && tagsDB.map(tag => <option key={tag.id} value={tag.id}>{tag.tagName}</option>)}\n                </select>\n\n                <label>Description</label>\n                <textarea className=\"description\" onChange={event => setDescription(event.target.value)} />\n\n                <label>Images</label>\n                <div className=\"images\">\n\n                    {previewImage && previewImage.map((img,index) =><div className=\"img-card\"  key={img} >\n                        <img src={img} />\n                        <button type=\"button\" onClick={()=>{\n                            setImages(images.filter((item, i) => index != i ))\n                            setPreviewImage(previewImage.filter((item, i) => index != i ))\n\n                            }}>remove</button>\n                    </div>)}\n                    \n                    <div className=\"add-button\"><button type=\"button\" onClick={()=>{imagesRef.current.click()}}>Add Image</button></div>\n                </div>\n                <div>\n                    <input style={{display:'none'}} ref={imagesRef} onChange={imagesLoadHandler} className=\"image-input\" name=\"images\" type={'file'}  accept={'.jpg , .png , .jpeg'} />\n                </div>\n                <label>File</label>\n                <input  className=\"file\" name=\"file\" type={'file'} onChange={event => setFile(event.target.files[0])} accept=\".rar , .zip , .tar\" />\n\n                <label>Price</label>\n                <input className=\"price\" type={'number'} min={1} max={10000} onChange={event=>setPrice(event.target.value)} />\n\n                <button type=\"submit\" >upload</button>\n            </form>\n        </div>            \n        \n        \n    </div>\n}\n\n\nexport default Upload"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,UAAU,CAAEC,SAAS,CAAEC,MAAM,CAAEC,QAAQ,KAAQ,OAAO,CACtE,OAASC,UAAU,KAAQ,OAAO,CAClC,OAASC,WAAW,KAAQ,mCAAmC,CAC/D,MAAO,CAAAC,aAAa,KAAM,8CAA8C,CACxE,MAAO,cAAc,QAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAGrB,KAAM,CAAAC,MAAM,CAAGC,KAAK,EAAI,CACpB,KAAM,CAACC,MAAM,CAAEC,SAAS,CAAC,CAAGX,QAAQ,CAAC,CAAC,CACtC,KAAM,CAACY,MAAM,CAAEC,SAAS,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACc,YAAY,CAAEC,eAAe,CAAC,CAAGf,QAAQ,CAAC,EAAE,CAAC,CAEpD,KAAM,CAACgB,KAAK,CAAEC,QAAQ,CAAC,CAAGjB,QAAQ,CAAC,CAAC,CACpC,KAAM,CAACkB,WAAW,CAAEC,cAAc,CAAC,CAAGnB,QAAQ,CAAC,CAAC,CAChD,KAAM,CAACoB,KAAK,CAAEC,QAAQ,CAAC,CAAGrB,QAAQ,CAAC,CAAC,CAAC,CACrC,KAAM,CAACsB,IAAI,CAAEC,OAAO,CAAC,CAAGvB,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAACwB,IAAI,CAAEC,OAAO,CAAC,CAAGzB,QAAQ,CAAC,CAAC,CAGlC,KAAM,CAAC0B,OAAO,CAACC,UAAU,CAAC,CAAG3B,QAAQ,CAAC,KAAK,CAAC,CAE5C,KAAM,CAAA4B,SAAS,CAAE7B,MAAM,CAAC,CAAC,CAEzB,KAAM,CAAA8B,IAAI,CAAGhC,UAAU,CAACK,WAAW,CAAC,CAEpC,KAAM,CAAA4B,OAAO,CAAG7B,UAAU,CAAC,CAAC,CAE5B,KAAM,CAAA8B,mBAAmB,CAAGC,KAAK,EAAI,CACjC,GAAI,CAAAC,OAAO,CAAGD,KAAK,CAACE,aAAa,CAACC,eAAe,CACjD,GAAI,CAAAC,MAAM,CAAG,EAAE,CACf,IAAI,GAAI,CAAAC,CAAC,CAAE,CAAC,CAAEA,CAAC,CAACJ,OAAO,CAACK,MAAM,CAAED,CAAC,EAAE,CAC/BD,MAAM,CAACG,IAAI,CAACN,OAAO,CAACI,CAAC,CAAC,CAACG,KAAK,CAAC,CACjCC,OAAO,CAACC,GAAG,CAACN,MAAM,CAAC,CACnBb,OAAO,CAACa,MAAM,CAAC,CACnB,CAAC,CACD,KAAM,CAAAO,iBAAiB,CAAGX,KAAK,EAAI,CAC/B,GAAI,CAAAY,KAAK,CAAGZ,KAAK,CAACa,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CACjCjC,SAAS,CAAC,CAAC,GAAGD,MAAM,CAAGgC,KAAK,CAAC,CAAC,CAE9B,GAAI,CAAAG,UAAU,CAAG,GAAI,CAAAC,UAAU,CAAC,CAAC,CAGjCD,UAAU,CAACE,MAAM,CAAG,IAAM,CACvBlC,eAAe,CAAC,CAAC,GAAGD,YAAY,CAAEiC,UAAU,CAACG,MAAM,CAAC,CAAC,CACxD,CAAC,CAEDH,UAAU,CAACI,aAAa,CAACP,KAAK,CAAC,CAInC,CAAC,CAED9C,SAAS,CAAC,IAAM,CAEZsD,KAAK,CAAC,gCAAgC,CAAE,CACpCC,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACL,cAAc,CAAE,kBACpB,CACJ,CAAC,CAAC,CAACC,IAAI,CAACC,GAAG,EAAIA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CAACF,IAAI,CAACG,IAAI,EAAI/C,SAAS,CAAC+C,IAAI,CAACpC,IAAI,CAAC,CAAC,CACjE,CAAC,CAAE,EAAE,CAAC,CAGN,KAAM,CAAAqC,aAAa,CAAG,KAAM,CAAA3B,KAAK,EAAG,CAChCA,KAAK,CAAC4B,cAAc,CAAC,CAAC,CACtBjC,UAAU,CAAC,IAAI,CAAC,CAChB,GAAG,CACC,GAAI,CAAAkC,QAAQ,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC7BD,QAAQ,CAACE,MAAM,CAAC,aAAa,CAAC/C,KAAK,CAAC,CACpC,IAAI,GAAI,CAAAqB,CAAC,CAAC,CAAC,CAAEA,CAAC,CAAEf,IAAI,CAACgB,MAAM,CAAGD,CAAC,EAAE,CAC7BwB,QAAQ,CAACE,MAAM,CAAC,MAAM,CAACzC,IAAI,CAACe,CAAC,CAAC,CAAC,CACnCwB,QAAQ,CAACE,MAAM,CAAC,aAAa,CAAC7C,WAAW,CAAC,CAC1C2C,QAAQ,CAACE,MAAM,CAAC,OAAO,CAACvC,IAAI,CAAC,CAC7B,IAAI,GAAI,CAAAa,CAAC,CAAC,CAAC,CAAEA,CAAC,CAAEzB,MAAM,CAAC0B,MAAM,CAAGD,CAAC,EAAE,CAC/BwB,QAAQ,CAACE,MAAM,CAAC,OAAO,CAACnD,MAAM,CAACyB,CAAC,CAAC,CAAC,CACtCwB,QAAQ,CAACE,MAAM,CAAC,OAAO,CAAC3C,KAAK,CAAC,CAC9ByC,QAAQ,CAACE,MAAM,CAAC,SAAS,CAAClC,IAAI,CAACmC,MAAM,CAAC,CAEtCvB,OAAO,CAACC,GAAG,CAACmB,QAAQ,CAACI,GAAG,CAAC,MAAM,CAAC,CAAC,CAEjC,KAAM,CAAAT,GAAG,CAAG,KAAM,CAAAJ,KAAK,CAAC,sCAAsC,CAAC,CAC3DC,MAAM,CAAC,MAAM,CACbC,OAAO,CAAC,CACJY,aAAa,CAAC,SAAS,CAACrC,IAAI,CAACsC,KACjC,CAAC,CACDC,IAAI,CAAEP,QACV,CAAC,CAAC,CACF,KAAM,CAAAH,IAAI,CAAG,KAAM,CAAAF,GAAG,CAACC,IAAI,CAAC,CAAC,CAC7B,GAAGD,GAAG,CAACa,EAAE,CACLvC,OAAO,CAACS,IAAI,CAAC,GAAG,CAAC,CACrBE,OAAO,CAACC,GAAG,CAACgB,IAAI,CAACY,OAAO,CAAC,CAC7B,CAAC,MAAMC,GAAG,CAAC,CACP9B,OAAO,CAACC,GAAG,CAAC6B,GAAG,CAAC,CACpB,CACA5C,UAAU,CAAC,KAAK,CAAC,CAErB,CAAC,CAED6C,QAAQ,CAACxD,KAAK,CAAG,QAAQ,CACzB,mBAAQT,KAAA,QAAKkE,SAAS,CAAC,kBAAkB,CAAEC,KAAK,CAAE,CAAEC,eAAe,CAAE,qDAAsD,CAAE,CAAAC,QAAA,eACzHvE,IAAA,CAACF,aAAa,EAAE0E,SAAS,CAAEnD,OAAQ,CAAG,CAAC,cACvCnB,KAAA,QAAKkE,SAAS,CAAC,QAAQ,CAAAG,QAAA,eACnBvE,IAAA,OAAAuE,QAAA,CAAI,gBAAc,CAAI,CAAC,cACvBrE,KAAA,SAAMuE,QAAQ,CAAEnB,aAAc,CAAAiB,QAAA,eAC1BvE,IAAA,UAAAuE,QAAA,CAAO,OAAK,CAAO,CAAC,cACpBvE,IAAA,UAAOoE,SAAS,CAAC,MAAM,CAACM,QAAQ,CAAE/C,KAAK,EAAEf,QAAQ,CAACe,KAAK,CAACa,MAAM,CAACL,KAAK,CAAE,CAAE,CAAC,cAEzEnC,IAAA,UAAAuE,QAAA,CAAO,MAAI,CAAO,CAAC,cACnBvE,IAAA,WAAQoE,SAAS,CAAC,MAAM,CAACO,QAAQ,MAACD,QAAQ,CAAEhD,mBAAoB,CAAA6C,QAAA,CAC3DlE,MAAM,EAAIA,MAAM,CAACuE,GAAG,CAACC,GAAG,eAAI7E,IAAA,WAAqBmC,KAAK,CAAE0C,GAAG,CAACC,EAAG,CAAAP,QAAA,CAAEM,GAAG,CAACE,OAAO,EAAnCF,GAAG,CAACC,EAAwC,CAAC,CAAC,CACpF,CAAC,cAET9E,IAAA,UAAAuE,QAAA,CAAO,aAAW,CAAO,CAAC,cAC1BvE,IAAA,aAAUoE,SAAS,CAAC,aAAa,CAACM,QAAQ,CAAE/C,KAAK,EAAIb,cAAc,CAACa,KAAK,CAACa,MAAM,CAACL,KAAK,CAAE,CAAE,CAAC,cAE3FnC,IAAA,UAAAuE,QAAA,CAAO,QAAM,CAAO,CAAC,cACrBrE,KAAA,QAAKkE,SAAS,CAAC,QAAQ,CAAAG,QAAA,EAElB9D,YAAY,EAAIA,YAAY,CAACmE,GAAG,CAAC,CAACI,GAAG,CAACC,KAAK,gBAAI/E,KAAA,QAAKkE,SAAS,CAAC,UAAU,CAAAG,QAAA,eACrEvE,IAAA,QAAKkF,GAAG,CAAEF,GAAI,CAAE,CAAC,cACjBhF,IAAA,WAAQmF,IAAI,CAAC,QAAQ,CAACC,OAAO,CAAEA,CAAA,GAAI,CAC/B5E,SAAS,CAACD,MAAM,CAAC8E,MAAM,CAAC,CAACC,IAAI,CAAEtD,CAAC,GAAKiD,KAAK,EAAIjD,CAAE,CAAC,CAAC,CAClDtB,eAAe,CAACD,YAAY,CAAC4E,MAAM,CAAC,CAACC,IAAI,CAAEtD,CAAC,GAAKiD,KAAK,EAAIjD,CAAE,CAAC,CAAC,CAE9D,CAAE,CAAAuC,QAAA,CAAC,QAAM,CAAQ,CAAC,GANsDS,GAO3E,CAAC,CAAC,cAEPhF,IAAA,QAAKoE,SAAS,CAAC,YAAY,CAAAG,QAAA,cAACvE,IAAA,WAAQmF,IAAI,CAAC,QAAQ,CAACC,OAAO,CAAEA,CAAA,GAAI,CAAC7D,SAAS,CAACgE,OAAO,CAACC,KAAK,CAAC,CAAC,EAAE,CAAAjB,QAAA,CAAC,WAAS,CAAQ,CAAC,CAAK,CAAC,EACnH,CAAC,cACNvE,IAAA,QAAAuE,QAAA,cACIvE,IAAA,UAAOqE,KAAK,CAAE,CAACoB,OAAO,CAAC,MAAM,CAAE,CAACC,GAAG,CAAEnE,SAAU,CAACmD,QAAQ,CAAEpC,iBAAkB,CAAC8B,SAAS,CAAC,aAAa,CAACuB,IAAI,CAAC,QAAQ,CAACR,IAAI,CAAE,MAAO,CAAES,MAAM,CAAE,qBAAsB,CAAE,CAAC,CAClK,CAAC,cACN5F,IAAA,UAAAuE,QAAA,CAAO,MAAI,CAAO,CAAC,cACnBvE,IAAA,UAAQoE,SAAS,CAAC,MAAM,CAACuB,IAAI,CAAC,MAAM,CAACR,IAAI,CAAE,MAAO,CAACT,QAAQ,CAAE/C,KAAK,EAAIP,OAAO,CAACO,KAAK,CAACa,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAAE,CAACmD,MAAM,CAAC,oBAAoB,CAAE,CAAC,cAEpI5F,IAAA,UAAAuE,QAAA,CAAO,OAAK,CAAO,CAAC,cACpBvE,IAAA,UAAOoE,SAAS,CAAC,OAAO,CAACe,IAAI,CAAE,QAAS,CAACU,GAAG,CAAE,CAAE,CAACC,GAAG,CAAE,KAAM,CAACpB,QAAQ,CAAE/C,KAAK,EAAEX,QAAQ,CAACW,KAAK,CAACa,MAAM,CAACL,KAAK,CAAE,CAAE,CAAC,cAE9GnC,IAAA,WAAQmF,IAAI,CAAC,QAAQ,CAAAZ,QAAA,CAAE,QAAM,CAAQ,CAAC,EACpC,CAAC,EACN,CAAC,EAGL,CAAC,CACV,CAAC,CAGD,cAAe,CAAApE,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}